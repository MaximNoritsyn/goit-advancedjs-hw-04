{"version":3,"file":"commonHelpers.js","sources":["../src/js/api-services.js","../src/js/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY='40188796-142b3a6aed6b1a3d407973769';\naxios.defaults.baseURL = \"https://pixabay.com\";\naxios.defaults.params = {\n    key: API_KEY,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n    per_page: 40,\n};\n\nexport async function fetchImages(query, page) {\n    const { data } = await axios.get(\"api/\", {\n        params: { q: query, page: page },\n    });\n    return {\n        images: data.hits,\n        totalImages: data.totalHits,\n    };\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { fetchImages } from \"./api-services\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n    captionsData: \"alt\",\n    captionDelay: 250,\n});\n\nconst vars = {\n    page: 1,\n    query: \"\",\n    cardHeight: 0,\n};\n\nconst selectors = {\n    form: document.querySelector(\"form\"),\n    input: document.querySelector(\"input\"),\n    button: document.querySelector(\"button\"),\n    gallery: document.querySelector(\".gallery\"),\n    loadMore: document.querySelector(\".load-more\"),\n};\n\nselectors.form.addEventListener(\"submit\", handlerSubmit);\nselectors.loadMore.addEventListener(\"click\", loadMoreHandler);\n\nfunction sendError(message) {\n    const options = {\n        message,\n        position: \"topRight\",\n    };\n    iziToast.error(options);\n}\n\nfunction sendSuccess(message) {\n    const options = {\n        message,\n        position: \"topRight\",\n    };\n    iziToast.success(options);\n}\n\nfunction loadMoreSettings(hidden = true) {\n    if (hidden) {\n        selectors.loadMore.classList.add(\"is-hidden\");\n        return;\n    }\n    selectors.loadMore.classList.remove(\"is-hidden\");\n}\n\nasync function fetchMoreImages() {\n    try {\n        const { images, totalImages } = await fetchImages(vars.query, vars.page);\n        if (images.length === 0) {\n            sendError(\"Sorry, there are no images matching your search query. Please try again.\")\n            return;\n        }\n        if (vars.page === 1) {\n            sendSuccess(`Hooray! We found ${totalImages} images.`)\n        }\n\n        selectors.gallery.insertAdjacentHTML(\"beforeend\", murkupImages(images));\n        lightbox.refresh();\n\n        if (vars.page >= (totalImages / 40)) {\n            sendError(\"We're sorry, but you've reached the end of search results.\")\n        }\n        else {\n            loadMoreSettings(false);\n        }\n\n        vars.cardHeight = selectors.gallery.firstElementChild.clientHeight;\n        window.scrollBy({\n            top: vars.cardHeight - 200,\n            behavior: \"smooth\",\n        });\n\n    } catch (error) {\n        sendError(\"Sorry, something went wrong. Please try again.\")\n        loadMoreSettings(true);\n    }\n}\n\nfunction handlerSubmit(event) {\n    event.preventDefault();\n    loadMoreSettings(true);\n    selectors.gallery.innerHTML = \"\";\n    const search_value = selectors.input.value.trim();\n    if (search_value === \"\") { \n        sendError(\"Please enter a search query.\");\n        return;\n    }\n    if (search_value === vars.query) {\n        vars.page += 1;\n    }\n    else {\n        vars.query = search_value;\n        vars.page = 1;\n    }\n    \n    fetchMoreImages();\n}\n\nfunction loadMoreHandler() {\n    vars.page += 1;\n    fetchMoreImages();\n}\n\nfunction murkupImages(images) {\n    return images.map(({ id,\n        webformatURL,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n        tags\n    }) => {\n        return `\n        <a class=\"photo-card\" href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n                <p class=\"info-item\">\n                    <b>Likes</b>\n                    ${likes}\n                </p>\n                <p class=\"info-item\">\n                    <b>Views</b>\n                    ${views}\n                </p>\n                <p class=\"info-item\">\n                    <b>Comments</b>\n                    ${comments}\n                </p>\n                <p class=\"info-item\">\n                    <b>Downloads</b>\n                    ${downloads}\n                </p>\n            </div>\n        </a>`;\n    }).join(\"\");\n}\n"],"names":["API_KEY","axios","fetchImages","query","page","data","lightbox","SimpleLightbox","vars","selectors","handlerSubmit","loadMoreHandler","sendError","message","options","iziToast","sendSuccess","loadMoreSettings","hidden","fetchMoreImages","images","totalImages","murkupImages","event","search_value","id","webformatURL","largeImageURL","likes","views","comments","downloads","tags"],"mappings":"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"}