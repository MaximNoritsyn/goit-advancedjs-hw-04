{"version":3,"file":"commonHelpers.js","sources":["../src/js/api-services.js","../src/js/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY='40188796-142b3a6aed6b1a3d407973769';\naxios.defaults.baseURL = \"https://pixabay.com\";\naxios.defaults.params = {\n    key: API_KEY,\n    image_type: \"photo\",\n    orientation: \"horizontal\",\n    safesearch: true,\n    per_page: 40,\n};\n\nexport async function fetchImages(query, page) {\n    const { data } = await axios.get(\"api\", {\n        params: { q: query, page: page },\n    });\n    return {\n        images: data.hits,\n        totalImages: data.totalHits,\n    };\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { fetchImages } from \"./api-services\";\n\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst lightbox = new SimpleLightbox(\".gallery a\", {\n    captionsData: \"alt\",\n    captionDelay: 250,\n});\n\nconst vars = {\n    page: 1,\n    query: \"\",\n    cardHeight: 0,\n};\n\nconst selectors = {\n    form: document.querySelector(\"form\"),\n    input: document.querySelector(\"input\"),\n    button: document.querySelector(\"button\"),\n    gallery: document.querySelector(\".gallery\"),\n    loadMore: document.querySelector(\".load-more\"),\n};\n\nselectors.form.addEventListener(\"submit\", handlerSubmit);\nselectors.loadMore.addEventListener(\"click\", loadMoreHandler);\n\nfunction sendError(message, title = \"\") {\n    const options = {\n        message,\n        position: \"topRight\",\n    };\n    if (title) {\n        options.title = title;\n    }\n    iziToast.error(options);\n}\n\nfunction sendSuccess(message) {\n    const options = {\n        message,\n        position: \"topRight\",\n    };\n    iziToast.success(options);\n}\n\nfunction loadMoreSettings(hidden = true) {\n    if (hidden) {\n        selectors.loadMore.classList.add(\"is-hidden\");\n        return;\n    }\n    selectors.loadMore.classList.remove(\"is-hidden\");\n}\n\nasync function fetchMoreImages() {\n    try {\n        const { images, totalImages } = await fetchImages(vars.query, vars.page);\n        if (images.length === 0) {\n            sendError(\"Sorry, there are no images matching your search query. Please try again.\")\n            loadMoreSettings(true)\n            return;\n        }\n        if (vars.page >= (totalImages / 40)) {\n            sendSuccess(\"Hooray! We found totalHits images.\")\n            loadMoreSettings(true);\n        }\n        else {\n            loadMoreSettings(false);\n        }\n\n        selectors.gallery.insertAdjacentHTML(\"beforeend\", murkupImages(images));\n        lightbox.refresh();\n\n        vars.cardHeight = selectors.gallery.firstElementChild.clientHeight;\n        window.scrollBy({\n            top: vars.cardHeight - 200,\n            behavior: \"smooth\",\n        });\n\n    } catch (error) {\n        sendError(\"Sorry, something went wrong. Please try again.\")\n        loadMoreSettings(true);\n    }\n}\n\nfunction handlerSubmit(event) {\n    event.preventDefault();\n    selectors.gallery.innerHTML = \"\";\n    if (selectors.input.value === \"\") { \n        sendError(\"Please enter a search query.\");\n        return;\n    }\n    if (selectors.input.value === vars.query) {\n        vars.page += 1;\n    }\n    else {\n        vars.query = selectors.input.value;\n        vars.page = 1;\n    }\n    \n    fetchMoreImages();\n}\n\nfunction loadMoreHandler() {\n    vars.page += 1;\n    fetchMoreImages();\n}\n\nfunction murkupImages(images) {\n    return images.map(({ id,\n        webformatURL,\n        largeImageURL,\n        likes,\n        views,\n        comments,\n        downloads,\n        tags\n    }) => {\n        return `\n        <a class=\"photo-card\" href=\"${largeImageURL}\">\n            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n            <div class=\"info\">\n                <p class=\"info-item\">\n                    <b>Likes</b>\n                    ${likes}\n                </p>\n                <p class=\"info-item\">\n                    <b>Views</b>\n                    ${views}\n                </p>\n                <p class=\"info-item\">\n                    <b>Comments</b>\n                    ${comments}\n                </p>\n                <p class=\"info-item\">\n                    <b>Downloads</b>\n                    ${downloads}\n                </p>\n            </div>\n        </a>`;\n    }).join(\"\");\n}\n"],"names":["API_KEY","axios","fetchImages","query","page","data","lightbox","SimpleLightbox","vars","selectors","handlerSubmit","loadMoreHandler","sendError","message","title","options","iziToast","sendSuccess","loadMoreSettings","hidden","fetchMoreImages","images","totalImages","murkupImages","event","id","webformatURL","largeImageURL","likes","views","comments","downloads","tags"],"mappings":"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"}